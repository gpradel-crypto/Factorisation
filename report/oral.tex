\documentclass[utf8,10pt,french]{beamer}
\usepackage[french]{babel}
\usepackage{listings}
\usepackage{amsfonts}
\usepackage{color}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
%\usepackage{listings}
\usepackage{verbatim}
%\input{defs.tex}
\usepackage{listings} %for code citations
\usepackage{fancyhdr} %for footers / headers
\usepackage{array}
\usepackage{tabularx}
\usepackage{mathabx}
\usepackage[french,ruled]{algorithm2e}
\usepackage{pdfpages}

\usetheme{Singapore}
%\usecolortheme{wolverine}
%\usetheme{Copenhagen}
%\usetheme{Hannover}

\newcommand{\nam}[1]{\texttt{\color{blue}#1}}
\newcommand{\com}[1]{\texttt{\color{red}#1}}
\newcommand{\var}[1]{\textit{\color{green!50!black}#1}}
\newtheorem{theoreme}{Th{\'e}or{\`e}me}
\newtheorem{lemme}{Lemme}

\title[FdE]{Factorisation des entiers}
\author[GV]{\textsc{Gaëtan Pradel \& Vincent Dalsheimer}}
\institute{Université Bordeaux 1}


\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\SetKwInput{KwIn}{Entrées}
\SetKwInput{KwOut}{Sorties}
\SetKw{Return}{Retourner}
\SetKwRepeat{Repeat}{Répéter}{jusqu'à}
\DeclareMathOperator{\pgcd}{pgcd}
\DeclareMathOperator{\ppcm}{ppcm}

\begin{document}

\frame{\titlepage}

\section{Introduction}
\begin{frame}{Introduction}
Certains algorithmes de chiffrement reposent sur une clef privée qui est la factorisation de la clef publique $n$ (ex : RSA). \pause

\begin{theoreme}[Théorème fondamental de l'arithmétique]
Tout entier strictement positif peut être écrit comme un produit de nombres premiers d’une
unique façon, à l’ordre près des facteurs. \pause
\end{theoreme}

Plus les algorithmes de factorisation sont performants, plus les clefs doivent être grandes.
\end{frame}

\section*{Sommaire}
\begin{frame}{Sommaire}
  \tableofcontents
\end{frame}

\section{Rappels sur RSA}
\subsection{}
\begin{frame}{Rappels sur RSA}
\begin{itemize}
\item Chiffrement asymétrique $\to$ paire de clefs :\pause
\begin{itemize}
\item Clef publique : $n = pq$ \pause
\item Clef privée : peut être trouvée à partir de $p$ et $q$ \pause
\end{itemize}
\item Factoriser $n$ revient à casser RSA. \pause
\item Création de la clef privée : \pause 
\begin{itemize}
\item Calculer $\phi(n) = (p - 1)(q - 1)$ \pause
\item Choisir $e \in \N, e < \phi(n),$ premier avec $\phi(n)$ \pause
\item Calculer $d = e^{-1} \pmod \phi(n)$ \pause
\end{itemize}
\item $K_{\text{publique}} = (n, e)$ \pause
\item $K_{\text{privée}} = d$ \pause
\item $c \equiv m^e \pmod n$ \pause
\item $m \equiv c^d \pmod n$
\end{itemize}
\end{frame}

\section{Méthode de factorisation naïve}
\subsection{}
\begin{frame}{Méthode de factorisation naïve}
\begin{example}[Méthode la plus naïve]
\begin{itemize}    
\item $n = 15$ 
\item $15 \not\equiv 0 \pmod 2$
\item $15 \equiv 0 \pmod 3$ 
\item $5 \not\equiv 0 \pmod 4$ 
\item $5 \equiv 0 \pmod 5$
\item $n = 3 \times 5$
\end{itemize}
\end{example}
\end{frame}

\begin{frame}
\begin{example}[Méthode améliorée avec le crible d'{\'E}ratosthène]
\begin{itemize}
\item $n = 28$    
\item Premiers inférieurs à $\lfloor\sqrt(n)\rfloor : 2, 3, 5$
\item $28 \equiv 0 \pmod 2$
\item $14 \equiv 0 \pmod 2$
\item $7 \not\equiv 0 \pmod 2$
\item $7 \not\equiv 0 \pmod 3$
\item $7 \not\equiv 0 \pmod 5$
\item $7 \equiv 0 \pmod 7$
\item $n = 2^2 \times 7$
\end{itemize}
\end{example}
\end{frame}

\section{Algorithme $p - 1$ de Pollard}
\subsection{}
\begin{frame}{Quelques données importantes}
\begin{definition}[Entier friable]
Un entier $n$ est dit $B$-friable ou $B$-lisse si tous ses facteurs premiers sont inférieurs ou égaux à $B.$
\end{definition} \pause

\begin{definition}[Entier ultrafriable]
Un entier $n$ est dit $B$-ultrafriable ou $B$-superlisse si toute puissance $p^r$ d’un nombre premier qui divise $n$ vérifie :
\begin{center}
$p^r \leq B$
\end{center}
\end{definition} \pause

\begin{lemme}
Si $m$ est $B$-ultrafriable pour un certain seuil $B$, alors $m | \ppcm(1, ..., B).$
\end{lemme}
\end{frame}

\begin{frame}{Principe}
\begin{theoreme}[Petit théorème de Fermat]
Soient $p$ un nombre premier et $a$ est un entier non divisible par p. Alors,
\begin{center}  
$a^{p - 1} \equiv 1 \pmod p$
\end{center}
\end{theoreme} \pause
Ainsi, pour tout multiple $M$ de $p - 1$,
\begin{center}
$a^M \equiv 1 \pmod p$
\end{center} \pause
D'après le lemme précédent, si l'on pose $M = \ppcm(1, ..., B),$
\begin{center}
$a^M \equiv 1 \pmod p$ pour tout $a$ premier avec $p.$
\end{center} \pause
Donc $p | a^M - 1,$ et $p | \pgcd(a^M - 1, n).$
\end{frame}

\begin{frame}{Pseudo-code}
\begin{algorithm}[H]
\caption{Factorisation de $n$ par $p-1$ de Pollard}
\KwIn{Un entier $n$}
\KwOut{Un facteur $f$ de $n$}
\BlankLine
$x \gets Random([\![1,n-1]\!])$\;
$f = 1$\;
$k = 2$\;
$x \gets x^k$\;
$lim$\;
\Repeat{$p \neq 1$ // $k == lim$}{$x \gets x^{k!} \pmod n$\;$f = pgcd(x - 1, n)$\;$k = k + 1$\;}
\Return{$f$}
\end{algorithm}
\end{frame}

\begin{frame}{Limites et améliorations}
\begin{itemize}
\item $p - 1$ doit être $B$-ultrafriable.
\end{itemize} \pause
\begin{definition}
$n$ est dit $(B, C)$-friable s’il est le produit de premiers inférieurs à $B$ et d’au plus un premier dans l’intervalle $]B, C].$ \pause
\end{definition}
\begin{itemize}
\item Large prime variation \pause
\begin{itemize}
\item On calcule $x_{k + 1} = x^{k+1} \pmod n$ jusqu'à $x_B.$ \pause
\item On calcule ensuite $y_1 = x_B^{l_1} \pmod n, y_2 = x_B^{l_2} \pmod n, ...$ \pause
\item On a donc $y_{k + 1} \equiv  y_kx_B^{l_{k+1} - l_k} \pmod n$
\end{itemize}
\end{itemize}
\end{frame}

\section{Crible de Dixon}
\subsection{}
\begin{frame}{Principe}
Se base sur la recherche de congruences de carrés :
On cherche $a$ et $b$ tels que
\begin{center}
$a^2 \equiv b^2 \pmod n$ et $a \not\equiv \pm{b} \pmod n$
\end{center} \pause
On a alors $(a - b)(a + b) \equiv 0 \pmod n.$
Il nous suffit ensuite de calculer $\pgcd(a - b, n)$ pour trouver un facteur de $n.$
\end{frame}

\begin{frame}{Pseudo-code}
\scalebox{0.8}{
\begin{algorithm}[H]
\caption{Factorisation de $n$ par le crible de Dixon}
\KwIn{Un entier $n$ et une borne $B$}
\KwOut{Un facteur de $n,$ ou 1 ou $n$}
\BlankLine
$P = \{p \text{ premiers } | p < B\}$\;
$k = \#P$\;
$L = liste\_relations$\;
\For{$i \in \{0, 1, ...,  k + 10\}$}{$x \gets Random([\![1,n-1]\!])$\; $y \equiv x^2 \pmod n$\;
\If{$y \text{ }B \text{-friable }$}{$L[i] \gets  x$}}
$M = (v_{p, i} \pmod 2)_{p \in P, 1 \leq i \leq k + 10} \text{ où } L[i]^2 \pmod n = \prod\limits_{p \in P}p^{v_{p,i}}$\;
Calculer le noyau de M. Soit $e = (e_1, ..., e_{k + 10}) \in \ker(M),$ c'est-à-dire :\\
$(e_1, ..., e_{k + 10}) \text{ tel que } M(e_1, ..., e_{k + 10})^t \equiv 0 \pmod 2$\;
$u = \prod\limits_{i = 1}^m L[i]^{e_i}$\;
$v = \prod\limits_{p \in P} p^{\frac{1}{2} \sum\limits_{i=1}^m v_{p, i}e_i}$\;
\Return{$\pgcd(u - v, n)$}
\end{algorithm}
}
\end{frame}

\begin{frame}{Quelques précisions}
\begin{itemize}
\item Si $n$ est impair et a $m$ facteurs premiers, $m \leq 2,$ alors la probabilité que l'algorithme renvoie un facteur trivial est égale à $\frac{1}{m^2} \leq \frac{1}{2}.$ \pause
\item La valeur optimale de $B$ est $\exp(\sqrt{\log(n)}).$
\item On a alors $T = \exp(\sqrt{2\log(n)\log\log(n)}.$
\item La complexité dépend de $n$ et non de son plus petit facteur premier.  
\end{itemize}
\end{frame}

\section{Crible quadratique}
\subsection{}
\begin{frame}{Principe}
Est une amélioration du crible de Dixon au niveau de la recherche des congruences : \pause
On choisit un entier $m \approx \lfloor\sqrt{n}\rceil.$ Ainsi, $m^2 - n$ est de l'ordre de $\sqrt{n}.$ \pause
On remarque que pour tout $a \in \N :$
\begin{center}
$(m + a)^2 \equiv (m^2 - n) + a^2 + 2am \pmod n.$
\end{center} \pause
On cherche donc des petits entiers $a$ tels que $(m^2 - n) + a^2 + 2am \pmod n$ soit $B$-friable.
\end{frame}

\begin{frame}{Pseudo-code}
\begin{algorithm}
\caption{Factorisation de $n$ par le crible quadratique}
\KwIn{Un entier $n$ et une borne $B$}
\KwOut{Un facteur de $n$}
\BlankLine
$m = \lfloor n^{\frac{1}{2}} \rceil$\;
$k = \#P$\;
$L = liste\_relations$\;
\For{$a \in \{-60,..., 60\}$}{$y = (m^2 - n) + a^2 + 2am \pmod n$\;
\If{$y \text{ }B \text{-friable }$}{$L[i] \gets  y$}}
$M = (v_{i, p} \pmod 2)_{a, p \in P} \text{ où } L[i] = \prod\limits_{p \in P}p^{v_{i,p}}$\;
$(e_1, ..., e_k) \text{ tel que } (e_1, ..., e_k)M = 0$\;
$u = \prod\limits_{p \in P} p^{\frac{1}{2} \sum\limits_{i=1}^k v_{i, p}e_i}$\;
$v = \prod\limits_{\substack{a | e_i \neq 0 \\ 1 \leq i \leq k}} (m + a)^2$\;
\Return{$\pgcd(u - v, n)$}
\end{algorithm}
\end{frame}

\begin{frame}

\end{frame}

\section{Conclusion}
\begin{frame}
  \frametitle{Conclusion}
Nous avons deux façon de produire une suite de nombres aléatoire :\pause
\begin{itemize}
\item Générateur congruentiel linéaire : rapide à l'implémentation mais facile à attaquer.\pause
\item Blum Blum Shub : cryptographiquement sûr mais bien plus lent que le GCL.
\end{itemize}
\end{frame}
\end{document}
